[[dashboard-monitoring-with-elastic-agent]]
=== Collect {ls} monitoring data with {agent} for dashboards
[subs="attributes"]
++++
<titleabbrev>{agent} collection</titleabbrev>
++++

You can use {agent} to collect data about {ls} and ship it to the monitoring
cluster. The benefit of {agent} collection is that the monitoring agent remains
active even if the {ls} instance does not. Plus you can manage all your
monitoring agents from a central location in {fleet}.

To collect and ship monitoring data:

. <<disable-default-include-ead,Disable default collection of monitoring metrics>>
. <<define-cluster__uuid-include-ead,Specify the target `cluster_uuid` (optional)>>
. <<configure-metricbeat,Install and configure {agent} to collect monitoring data>>

[float]
[[disable-default-include-ead]]
//include section about disabling default collection from the metricbeat topic
include::monitoring-mb.asciidoc[tag=disable-default-collection]

[float]
[[define-cluster__uuid-include-ead]]
//include section about defining cluster_uuid from the metricbeat topic
include::monitoring-mb.asciidoc[tag=define-cluster-uuid]

[float]
[[configure-elastic-agent-logstash-dashboards]]

== Install and configure {agent}


[discrete]
[[add-logstash-integration-ead]]
=== Step 1: Add the {agent} Logstash integration

{agent} is a single, unified way to add monitoring for logs, metrics, and other
types of data to a host. Each agent has a single policy you can update to add
integrations for new data sources, security protections, and more.

In this step, add the {ls} integration to monitor host logs and metrics.

. Go to the {kib} home page and click **Add integrations**.
+
--
[role="screenshot"]
image::images/kibana-home.png[{kib} home page]
--

. In the query bar, search for **Logstash** and select the integration to see more
details about it.

. Click **Add Logstash**.

. Configure the integration name and optionally add a description.

[[configure-logstash-logs-ead]]
==== Configure {agent} to collect {ls} Logs

Make sure that **Logs** is turned on.

--
[role="screenshot"]
image::images/integration-configure-logs.png[{kib} home page]
--

. Make sure you configure all required settings:
* Under **Logs**, modify the log paths
to match your {ls} environment.

[[configure-logstash-dashboards]]
==== Configure {agent} with Logstash Dashboards

Make sure that **Metrics (Technical Preview)** is turned on, and **Metrics (Stack Monitoring)** is turned off.


--
[role="screenshot"]
image::images/integration-configure-tech-preview.png[Configuration page for adding log paths to the {agent} System integration]
--


* Under **Metrics (Technical Preview)**, make sure the Logstash URL setting
points to your {ls} instance URLs. By default, the integration collects {ls}
monitoring metrics from `https://localhost:9600`. If that host and port number are not
correct, update the `Logstash URL` setting. If you configured {ls} to use encrypted
communications and/or a username and password, you must access it via HTTPS, and expand the **Advanced Settings** options, and fill in with the appropriate values for your {ls} instance.


. Click **Save and continue**. This step takes a minute or two to complete. When
it's done, you'll have an agent policy that contains a system integration policy
for the configuration you just specified.
+
--
[role="screenshot"]
image::images/integration-configure-save.png[Configuration page for adding the {agent} System integration]
--

. In the popup, click **Add {agent} to your hosts** to open the **Add agent**
flyout.
+
TIP: If you accidentally close the popup, go to **{fleet} > Agents**, then click
**Add agent** to access the flyout.



[discrete]
[[add-agent-to-fleet-ead]]

=== Step 2: Install and run an {agent} on your machine
// Include section about installing agents
include::monitoring-install.asciidoc[tag=install-agent-widget]

==== Step 3: Confirm Enrollment
// Include section about confirming enrollment
include::monitoring-confirm.asciidoc[tag=confirm-enrollment-widget]

[discrete]
[[view-data-dashboard]]
=== Step 4: Monitor Logstash logs and metrics (Logstash Metrics Dashboard Technical Preview)


. From the list of assets, open the **[Metrics Logstash] Logstash overview** dashboard to view overall performance. Then follow the navigation panel to further drill down into Logstash performance.
+
[role="screenshot"]
image::images/integration-dashboard-overview.png[The Logstash Overview dashboard in {kib} with various metrics from your monitored Logstash]

You can hover over any visualization to adjust its settings, or click the
**Edit** button to make changes to the dashboard. To learn more, refer to
{kibana-ref}/dashboard.html[Dashboard and visualizations].
