S3_OP_TYPE SOAP|REST|WEBSITE

S3_OPERATION %{S3_OP_TYPE:operation_type}\.%{WORD:operation}(\.%{WORD:resource_type})?

S3_REQUEST_LINE (?:%{WORD:verb} %{NOTSPACE:request}(?: HTTP/%{NUMBER:httpversion})?|%{DATA:rawrequest})

S3_ACCESS %{NOTSPACE:owner} %{NOTSPACE:bucket} \[%{HTTPDATE:timestamp}\] %{IP:clientip} %{NOTSPACE:requester} %{NOTSPACE:request_id} %{S3_OPERATION} %{NOTSPACE:key} "%{REQUEST_LINE}" %{INT:response:int} (?:%{NOTSPACE:error_code}|-) (?:%{INT:bytes:int}|-) (?:%{INT:object_size:int}|-) %{INT:request_time_ms:int} (:?%{INT:turnaround_time_ms:int}|-) %{QS:referrer} %{QS:agent} (:?%{NOTSPACE:version_id}|-)
