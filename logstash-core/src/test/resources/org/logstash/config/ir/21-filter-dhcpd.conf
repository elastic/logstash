# Generated by Chef for REDACTED
# Do NOT modify this file by hand.
#
filter {
	if ("syslog" in [tags] or "pfsense" in [tags]) {
		if [program] =~ /^dhcpd$/ {
			mutate {
				add_tag => [ "dhcp" ]
				id => "filter_mutate_add_dhcp_tag"
			}
			if [message] =~ /^DHCPACK|^DHCPREQUEST|^DHCPOFFER/ {
				grok {
					patterns_dir => [ "/etc/logstash/patterns" ]
					patterns_files_glob => "dhcpd"
					match => { "message" => "%{DHCPACK}" }
					id => "filter_grok_dhcpack"
				}
			}
			if [message] =~ /^DHCPDISCOVER/ {
				grok {
					patterns_dir => [ "/etc/logstash/patterns" ]
					patterns_files_glob => "dhcpd"
					match => { "message" => "%{DHCPDISCOVER}" }
					id => "filter_grok_dhcpdiscover"
				}
			}
			if [message] =~ /^DHCPINFORM/ {
				grok {
					patterns_dir => [ "/etc/logstash/patterns" ]
					patterns_files_glob => "dhcpd"
					match => { "message" => "%{DHCPINFORM}" }
					id => "filter_grok_dhcpinform"
				}
			}
		}	
	}
}