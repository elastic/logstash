# Generated by Chef for REDACTED
# Do NOT modify this file by hand.
#
filter {
	if [type] == "iptables" {
		grok {
			patterns_dir => [ "/etc/logstash/patterns" ]
			patterns_files_glob => "iptables*"
			match => { "message" => "%{IPTABLES}" }
			id => "filter_grok_iptables"
		}	
		date {
			match => [ "syslog_timestamp", "MMM d HH:mm:ss", "MMM  d HH:mm:ss", "MMM dd HH:mm:ss" ]
			locale => "en"
			timezone => "Europe/London"
			id => "filter_date_iptables"
		}	
		mutate {
			add_tag => [ "firewall", "iptables" ]
			id => "filter_mutate_iptables_add_tag"
		}
		if "_grokparsefailure" not in [tags] {
			mutate {
				copy => { "host" => "host_ip" }
				id => "filter_mutate_iptables_copy_host_ip"
			}
			dns {
				resolve => [ "host_ip" ]
				action => "replace"
				add_tag => [ "dns_host_lookup" ]
				id => "filter_dns_iptables_host_ip"
			}
			geoip {
				add_tag => [ "geoip_src" ]
				source => "src_ip"
				target => "geoip_src_ip"
				tag_on_failure => [ "_geoip_lookup_failure_src" ]
				id => "filter_geoip_iptables_src"
			}
			geoip {
				add_tag => [ "geoip_dst" ]
				source => "dst_ip"
				target => "geoip_dst_ip"
				tag_on_failure => [ "_geoip_lookup_failure_dst" ]
				id => "filter_geoip_iptables_dst"
			}
		}
	}
}