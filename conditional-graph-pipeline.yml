---
graph:
  log-reader:
    component: input-generator
    options: {"message": "Hello 123", "count": 50}
    to: [main-queue]
  main-queue:
    component: queue-synchronous
    to: [hello-grok]
  hello-grok:
    component: filter-grok
    options:
      match:
        message: "%{WORD:greeting} %{NUMBER:greetno}"
    to: [fizzbuzz]
  fizzbuzz:
    component: predicate-ifelse-ruby
    to:
      - ["event['[sequence]'] % 15 == 0", [fizzbuzzer]]
      - ["event['[sequence]'] % 5 == 0", [fizzer]]
      - ["event['[sequence]'] % 3 == 0", [buzzer]]
      - ["__ELSE__", [main-out]]
  fizzbuzzer:
    component: filter-mutate
    options:
      add_field:
        fb: fizzbuzz
    to: [main-out]
  fizzer:
    component: filter-mutate
    options:
      add_field:
        fb: fizz
    to: [main-out]
  buzzer:
    component: filter-mutate
    options:
      add_field:
        fb: buzz
    to: [main-out]
  main-out:
    component: output-stdout
    options:
      codec: json_lines